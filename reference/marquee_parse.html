<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="marquee uses an extension of CommonMark with no support for HTML code (it is
rendered verbatim). The focus is to allow easy formatting of text for
graphics, rather than fully fledged typesetting. See marquee syntax for
more about the format."><title>Parse a text as marquee — marquee_parse • marquee</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parse a text as marquee — marquee_parse"><meta property="og:description" content="marquee uses an extension of CommonMark with no support for HTML code (it is
rendered verbatim). The focus is to allow easy formatting of text for
graphics, rather than fully fledged typesetting. See marquee syntax for
more about the format."><meta property="og:image" content="https://marquee.r-lib.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="marquee.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">marquee</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/marquee.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/marquee_style.html">Marquee Styling</a>
    <a class="dropdown-item" href="../articles/marquee_syntax.html">Marquee Syntax</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/marquee/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parse a text as marquee</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/marquee/blob/HEAD/R/parse.R" class="external-link"><code>R/parse.R</code></a></small>
      <div class="d-none name"><code>marquee_parse.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>marquee uses an extension of CommonMark with no support for HTML code (it is
rendered verbatim). The focus is to allow easy formatting of text for
graphics, rather than fully fledged typesetting. See <em>marquee syntax</em> for
more about the format.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">marquee_parse</span><span class="op">(</span><span class="va">text</span>, <span class="va">style</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>text</dt>
<dd><p>A character string. The core quality of markdown is that any text
is valid markdown so there is no restrictions on the content</p></dd>


<dt>style</dt>
<dd><p>A style set such as <code><a href="classic_style.html">classic_style()</a></code> that defines how the text
should be rendered</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame describing the various tokens of the text and the style
to apply to them. The output is mainly meant for programmatic consumption
such as in <code><a href="marquee_grob.html">marquee_grob()</a></code></p>


    </div>
    <div class="section level2">
    <h2 id="marquee-tags">marquee tags<a class="anchor" aria-label="anchor" href="#marquee-tags"></a></h2>
    <p>marquee tokenizes the input text into blocks and spans. It recognises the
following tags:</p>
<p><strong>Block tags</strong></p>
<p><code>body</code> is the parent tag of a markdown document. It never contains any text
itself, only other blocks.</p>
<p><code>ul</code> is an unordered list. It contains a number of <code>li</code> children</p>
<p><code>ol</code> is an ordered list. It contains a number of <code>li</code> children</p>
<p><code>li</code> is a list element. If the list is tight it contains text directly inside
of it. If not, text are placed inside child <code>p</code> blocks</p>
<p><code>hr</code> is a horizontal line, spanning the width of the parent block. For
styling, the bottom border size is used when rendering</p>
<p><code>h1</code>-<code>h6</code> are headings at different levels</p>
<p><code>cb</code> is a code block. Text inside code blocks are rendered verbatim, i.e. it
cannot contain any children</p>
<p><code>p</code> is a standard paragraph block. Text separated by two line-ends are
separated into separate paragraphs</p>
<p><code>qb</code> is a quote block. It may contain children</p>
<p><strong>Span tags</strong></p>
<p><code>em</code> is an emphasized text span. Often this means italicizing the text, but
it is ultimately up to the renderer</p>
<p><code>str</code> is strong text, often rendered with bold text</p>
<p><code>a</code> is a link text. While marquee rendering doesn't allow for links, it can
still be rendered in a particular way</p>
<p><code>code</code> is text rendered as code. Often this uses a monospaced font. Text
inside this span is rendered verbatim</p>
<p><code>u</code> is text that should be underlined</p>
<p><code>del</code> is text that should have strikethrough</p>
<p><em>custom spans</em> is a marquee specific extension to the syntax that allows you
to make up tags on the fly. See the section on marquee syntax for more.</p>
    </div>
    <div class="section level2">
    <h2 id="marquee-syntax">marquee syntax<a class="anchor" aria-label="anchor" href="#marquee-syntax"></a></h2>
    <p>marquee uses md4c which is a fully CommonMark compliant markdown parser.
CommonMark is an effort to create an internally coherent markdown
specification, something that was missing from the original markdown
description. If you are used to writing markdown, you are used to CommonMark.
Below is a list of notable additions or details about the specific way
marquee handles CommonMark</p>
<p><strong>Underlines and strikethrough</strong></p>
<p>While not part of the basic CommonMark spec, underline and strikethrough are
supported by marquee using <code>_</code> and <code>~</code> (e.g. <code>_underline this_</code> and <code>~this was an error~</code>).</p>
<p><strong>Images</strong></p>
<p>Image tags (<code>![image title](path/to/image)</code>) are supported, but the title is
ignored. The path is returned as the token text.</p>
<p><strong>HTML</strong></p>
<p>HTML tags are ignored, i.e. they are rendered verbatim. This is not that
different from classic markdown rendering except that people often convert
markdown to HTML where these tags suddenly have meaning. They do not carry
any special significance when rendered with marquee</p>
<p><strong>Custom tags</strong></p>
<p>While markdown provides most of what is necessary for standard text markup,
there are situations, especially in visualisation, where we need something
more. Often users reach for inline HTML spans for that, but since HTML is
fully ignored in marquee this is not an option. Further, adding in HTML
decreases readability of the unformatted text a lot.</p>
<p>With marquee you can create a custom span using the <code>{.tag &lt;some text&gt;}</code>
syntax, e.g. <code>{.sm small text}</code> to wrap "small text" in the <code>sm</code> tag. You can
alternatively use <code>{#tag &lt;some text&gt;}</code> for the same effect. The only
difference is that in the former syntax the <code>.</code> is stripped from the tag name,
whereas in the latter the <code>#</code> remains part of the name. See the Styling
section for the primal use of the latter syntax.</p>
    </div>
    <div class="section level2">
    <h2 id="styling">Styling<a class="anchor" aria-label="anchor" href="#styling"></a></h2>
    <p>During parsing, each token is assigned a style based on the provided style
set. The styling is cascading, but without the intricacies of CSS. A child
element inherits the styling of it's parent for the options that are set to
<code>NULL</code> in the style matching the child tag. Any style element that are
<code><a href="style_helpers.html">relative()</a></code> are computed based on the value of the parent style element.
<code><a href="style_helpers.html">em()</a></code> elements are resolved based on the size element of the child style,
and <code><a href="style_helpers.html">rem()</a></code> elements are resolved using the size element of the <code>body</code> style.
If a style is not provided for the tag, it fully inherits the style of it's
parent.</p>
<p><strong>Automatic coloring</strong>
Recognizing that the primary use for custom tags may be to change the color
of some text, marquee provides a shortcut for this. If a style is not found
for the tag in the provided style set, marquee will check if the tag matches
a valid color (i.e. a string from <code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">grDevices::colors()</a></code>, or a valid hex
string, e.g. <code>#53f2a9</code>). If it is a valid color it will set this as the font
color of the style. This means that parsing "Color .red this red"
automatically sets the color of "this" to red, even if no style is provided
for the <code>red</code> tag. Likewise, parsing "Color #00FF00 me green" will
automatically set the color of "me" to #00FF00 (fully satuared green).</p>
    </div>
    <div class="section level2">
    <h2 id="additional-parsing-information">Additional parsing information<a class="anchor" aria-label="anchor" href="#additional-parsing-information"></a></h2>
    <p>Apart from splitting the text up into tokens, <code>marquee_parse()</code> also provides
some additional information useful for rendering the output in the expected
way. The <code>id</code> column refers the tokens back to the original input text, the
<code>block</code> relates tokens together into blocks. Block elements increment the
block count when they are entered, and decrement it when they are excited.
The <code>type</code> column provides the type of the block. The <code>indentation</code> column
provides the node level in the tree. A child block will increase the
indentation for as long as it is active. <code>ol_index</code> provides the number
associated with the ordered list element. <code>tight</code> indicates whether the list
is tight (i.e. it was provided with no empty lines between list elements).
The <code>ends</code> column indicate until which row in the output the tag is active
(i.e. the tag is closed after the row indicated by the value in this column).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">marquee_parse</span><span class="op">(</span><span class="st">"# Header of the example\nSome body text"</span>, <span class="fu"><a href="classic_style.html">classic_style</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 39</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   text               id block type  indentation ol_index tight  ends  size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>                  1     1 body            1        0 FALSE     3    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">"</span>Header of the…     1     2 h1              2        0 FALSE     2    27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">"</span>Some body tex…     1     3 p               2        0 FALSE     3    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 30 more variables: background &lt;list&gt;, color &lt;chr&gt;, family &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   weight &lt;int&gt;, italic &lt;lgl&gt;, width &lt;int&gt;, features &lt;list&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   lineheight &lt;dbl&gt;, align &lt;chr&gt;, tracking &lt;dbl&gt;, indent &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   hanging &lt;dbl&gt;, margin_top &lt;dbl&gt;, margin_right &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   margin_bottom &lt;dbl&gt;, margin_left &lt;dbl&gt;, padding_top &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   padding_right &lt;dbl&gt;, padding_bottom &lt;dbl&gt;, padding_left &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   border &lt;chr&gt;, border_size_top &lt;dbl&gt;, border_size_right &lt;dbl&gt;, …</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>, Martin Mitáš, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

  </div></footer></body></html>

